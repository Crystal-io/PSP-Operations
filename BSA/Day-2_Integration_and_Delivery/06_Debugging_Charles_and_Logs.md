# 06. Debugging, Logging и Observability

## Цель модуля
Дать системному аналитику структурированный и практичный подход к дебагингу и логированию:
- какие уровни дебага существуют
- какие инструменты применяются на каждом уровне
- как аналитик участвует в поиске проблем
- как читать логи и метрики без доступа к коду
- как говорить про это на интервью на уровне Senior

Фокус — мышление и методология, а не DevOps или разработка.

---

## 1. Зачем аналитику разбираться в дебагинге

В реальных продуктовых системах проблемы возникают из-за:
- сложных интеграций
- асинхронных сценариев
- сетевых сбоев
- high-load и гонок состояний
- некорректных бизнес-правил

Роль аналитика:
- локализовать проблему
- понять, где она возникла (client / network / backend / integration / data)
- помочь команде быстрее найти root cause

---

## 2. Уровни дебагинга (Debugging Layers)

### 2.1 Client-side (Web / Mobile)

Что смотрим:
- пользовательские шаги
- UI-ошибки
- корректность данных, отправляемых в API

Инструменты:
- Browser DevTools
- Mobile logs (Android Logcat, iOS Console)

Типовые проблемы:
- некорректный payload
- неправильная обработка ошибок
- race conditions на UI

---

### 2.2 Network level (Client ↔ Server)

Что смотрим:
- HTTP-запросы и ответы
- headers
- статус-коды
- тайминги

Инструменты:
- Charles Proxy
- Fiddler
- Proxyman

Типовые проблемы:
- таймауты
- неверные headers
- повторные запросы
- дубли из-за retries

---

### 2.3 Backend / Service level

Что смотрим:
- бизнес-логику
- переходы статусов
- ошибки сервисов

Инструменты:
- application logs
- error tracking (Sentry, Bugsnag)

Типовые проблемы:
- некорректная бизнес-логика
- unhandled exceptions
- проблемы с данными

---

### 2.4 Integration level

Что смотрим:
- взаимодействие между системами
- корректность контрактов
- синхронность / асинхронность

Инструменты:
- API logs
- integration dashboards
- mock-сервисы

Типовые проблемы:
- несовпадение контрактов
- дубликаты событий
- потерянные webhooks

---

### 2.5 Data level

Что смотрим:
- данные в БД
- консистентность статусов
- результаты операций

Инструменты:
- SQL
- админ-панели
- отчёты

Типовые проблемы:
- частично сохранённые данные
- рассинхронизация состояний
- ошибки миграций

---

## 3. Логирование: что важно аналитику

### 3.1 Что такое лог

Лог — это запись о событии в системе.

Аналитик должен понимать:
- какие события логируются
- как по логам восстановить сценарий
- какие данные не должны логироваться (PII)

---

### 3.2 Уровни логирования

- INFO — бизнес-события
- WARN — потенциальные проблемы
- ERROR — ошибки, требующие внимания
- DEBUG — детальная техническая информация

Аналитик чаще всего работает с INFO / WARN / ERROR.

---

## 4. Correlation ID и трассировка

Correlation / Trace ID — уникальный идентификатор запроса.

Зачем нужен:
- связать логи разных сервисов
- восстановить полный путь запроса
- ускорить расследование инцидентов

Best practice:
- передавать traceId через headers
- логировать его на всех уровнях

---

## 5. Метрики и мониторинг (Observability)

### 5.1 Метрики vs логи vs трейсы

| Тип | Что показывает | Когда использовать |
|-----|----------------|-------------------|
| Logs | Детали событий | Анализ конкретной ошибки |
| Metrics | Числа и тренды | Поиск деградаций |
| Traces | Путь запроса | Анализ latency |

---

### 5.2 Типовые метрики

- response time (p95/p99)
- error rate
- retry count
- timeout rate
- throughput

Для аналитика важно уметь интерпретировать, а не настраивать.

---

## 6. Подход аналитика к дебагингу (пошагово)

1. Зафиксировать симптом (что видит пользователь)
2. Определить уровень проблемы
3. Проверить network (Charles / logs)
4. Сопоставить запросы и ответы
5. Проверить статусы и данные
6. Сформулировать гипотезу
7. Передать разработке с контекстом

Хороший аналитик приносит не «не работает», а воспроизводимый сценарий.

---

## 7. Best practices логирования (чек-лист)

- логировать бизнес-события
- не логировать PII
- использовать correlationId
- единый формат логов
- договорённость по error codes
- логи пригодны для поддержки

---

## 8. Сравнение инструментов дебагинга

| Инструмент | Уровень | Когда использовать |
|------------|---------|-------------------|
| DevTools | Client | UI и payload |
| Charles | Network | API, headers |
| Application logs | Backend | Бизнес-логика |
| Sentry | Errors | Runtime ошибки |
| SQL | Data | Проверка состояния |

---

## 9. Типовые вопросы на интервью (с ответами)

**Вопрос:** Зачем аналитику Charles Proxy?
**Ответ:** Для анализа HTTP-трафика и поиска проблем на границе client–server.

**Вопрос:** Что такое correlationId и зачем он нужен?
**Ответ:** Для трассировки одного запроса через несколько сервисов.

**Вопрос:** В чём разница между логами и метриками?
**Ответ:** Логи — детали событий, метрики — агрегированные показатели.

**Вопрос:** Как аналитик участвует в расследовании инцидента?
**Ответ:** Воспроизводит сценарий, анализирует логи и формирует гипотезы.

**Вопрос:** Какие данные нельзя логировать?
**Ответ:** PII, пароли, токены, чувствительные персональные данные.

---

## Результат модуля

После этого модуля ты:
- понимаешь уровни дебагинга
- ориентируешься в инструментах
- умеешь читать логи и метрики
- системно подходишь к поиску проблем
- уверенно отвечаешь на вопросы по debugging и observability

Следующий модуль:
07_Testing_and_Integration_Types.md
